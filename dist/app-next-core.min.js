!function(e){"use strict";function t(e,t){if("/"===e.charAt(0)&&(e=e.slice(1)),"."!==e.charAt(0))return e;for(var n=e.split("/");"."===n[0]||".."===n[0];)".."===n.shift()&&t.pop();return t.concat(n).join("/")}function n(e){var t=d[e];return t&&!l[e]&&(l[e]=!0,t.execute()),t&&t.exports}function r(e){return p[e]||n(e)}function s(e,t){var n=[e];n.push.apply(n,t),v.push(n)}function i(e,n,o){if(Array.isArray(e)||"function"==typeof e)s(i,arguments);else{"function"==typeof n&&(o=n,n=[]);var a,c={};d[e]=a={exports:c,deps:n.map(function(n){return t(n,e.split("/").slice(0,-1))}),dependants:[],update:function(e,t){},execute:function(){var t=[];a.deps.map(function(e){var n;"exports"===e?n=a.exports:"module"===e?n=a:(n=p[e])||(n=(n=r(e)&&d[e].exports)&&n.default),t.push(n)});var n=o.apply(null,t);"object"!=typeof a.exports&&(a.exports={default:a.exports}),"object"==typeof n?(n.default=n.default||n,a.exports=c=n):n&&(c.default=n),a.lock=!0,a.dependants.forEach(function(t){d[t]&&!d[t].lock&&d[t].update(e,c)}),a.lock=!1}}}}function o(e){return h[e]||(h[e]=new Promise(function(t,n){var r,s,i;r=(f.baseURL||"")+"/"+e+".js",s=function(){if(delete h[e],v.length){var r=v.shift();r[0].call(this,e,r[1],r[2])}d[e]?t(e):n(new Error("Error loading module "+e))},(i=document.createElement("script")).async&&(i.async=!1),i.addEventListener("load",s,!1),i.src=r,u.appendChild(i)})),h[e]}function a(e){var t=d[e];if(!t)return Promise.reject(new Error("Module "+e+" not loaded"));var n=e+"!";return h[n]?h[n]:h[n]=Promise.all(t.deps.map(function(t){if(p[t]||/module|exports|require/.test(t))return Promise.resolve(t);if(d[t]){var n=t+"!";return l[t]||h[n]?e:h[n]=a(t).then(function(e){return h[n]=Promise.resolve(e),e})}return o(t).then(a)})).then(function(){return e})}function c(e){var r,s=t(e,[]);return(r=p[s])?Promise.resolve(r):(r=d[s])?l[s]?Promise.resolve(r.exports):a(s).then(n):o(s).then(a).then(n)}var u=document.getElementsByTagName("head")[0],h=Object.create(null),l=Object.create(null),d=Object.create(null),p=Object.create(null),v=[];i.amd={jQuery:!0};var f={set:function(e,t){"object"!=typeof t&&(t={default:t}),p[e]=t},get:r,has:function(e){return!!p[e]||!!d[e]},import:c,importAll:function(e){Array.isArray(e)||(e=[].slice.call(arguments));var t=[];return Promise.all(e.map(function(e){var n=/^(.+?)(\.([\w*]+))?$/.exec(e);return e=n[1],t.push(n[3]||"default"),c(e)})).then(function(e){return e.map(function(e,n){return"*"==t[n]?e:e[t[n]]})})},register:function e(n,i,o){if(Array.isArray(n))s(e,arguments);else{var a,c,u=Object.create(null);d[n]=a={exports:u,deps:i.map(function(e){return t(e,n.split("/").slice(0,-1))}),dependants:[],update:function(e,t){c.setters[a.deps.indexOf(e)](t)},execute:function(){a.deps.map(function(e){var t=p[e];t?a.update(e,t):(t=r(e)&&d[e].exports)&&(d[e].dependants.push(n),a.update(e,t))}),c.execute()}},c=o(function(e,t){return u[e]=t,a.lock=!0,a.dependants.forEach(function(e){d[e]&&!d[e].lock&&d[e].update(n,u)}),a.lock=!1,t})}},amdDefine:i,amdRequire:function(e,t){f.importAll(e).spread(t)}};e.System=f,e.define=i,Promise.prototype.spread||(Promise.prototype.spread=function(e){return this.then(function(e){return Promise.all(e)}).then(function(t){return e.apply(this,t)})})}(window),System.register("handlers/data",[],function(e,t){"use strict";t&&t.id;return{setters:[],execute:function(){e("AppNextDataEvents",class e{constructor(){this.waiting=!1}static from(t){const n=new e;return n.onCancel=t.onCancel,n.onData=t.onData,n.onError=t.onError,n.onPending=t.onPending,n.onReady=t.onReady,n}set onCancel(e){this.cancel=e}set onData(e){this.data=e}set onError(e){this.error=e}set onPending(e){this.pending=e}set onReady(e){this.ready=e}invokeCancelEvent(e){try{this.cancel&&this.cancel(e)}catch(e){this.invokeErrorEvent(e)}}invokeDataEvent(e){try{this.data&&this.data(e)}catch(e){this.invokeErrorEvent(e)}}invokeErrorEvent(e){this.error&&this.error(e)}invokePendingEvent(){try{this.waiting=!0,this.pending&&this.pending()}catch(e){this.invokeErrorEvent(e)}}invokeReadyEvent(){try{this.waiting||this.invokePendingEvent(),this.ready&&this.ready()}catch(e){this.invokeErrorEvent(e)}}})}}}),System.register("handlers/error",[],function(e,t){"use strict";var n,r;t&&t.id;return e("error",function(e){const t=r[n[e]];if(!t)return new Error;const s=new Error(t.message);return s.name=t.name,s}),{setters:[],execute:function(){!function(e){e[e.acceptNotSupported=0]="acceptNotSupported",e[e.captureNotSupported=1]="captureNotSupported",e[e.downloadNotSupported=2]="downloadNotSupported",e[e.featureTerminated=3]="featureTerminated",e[e.invalidConfig=4]="invalidConfig",e[e.invalidFactoryFunction=5]="invalidFactoryFunction",e[e.notificationError=6]="notificationError",e[e.notificationNotFound=7]="notificationNotFound",e[e.permissionDenied=8]="permissionDenied"}(n||(n={})),e("Errors",n),r={acceptNotSupported:{name:"accept not supported",message:'Input element "accept" attribute is not supported by this device'},captureNotSupported:{name:"capture not supported",message:'Input element "capture" attribute is not supported by this device'},downloadNotSupported:{name:"download not supported",message:'Link element "download" attribute is not supported by this device'},featureTerminated:{name:"feature terminated",message:"Current feature terminated due to user action"},invalidConfig:{name:"invalid config",message:"Config object is missing required members"},invalidFactoryFunction:{name:"invalid factory",message:"Factory function must provide a valid handler instance"},notificationError:{name:"notification error",message:"An error raised while handling notification"},notificationNotFound:{name:"notification not found",message:"Notification not found in service worker registration"},permissionDenied:{name:"permission denied",message:"Requested permission denied by user"}}}}}),System.register("providers/permission",["handlers/data","handlers/error"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextPermissionProvider",class extends n.AppNextDataEvents{constructor(e){super(),this.permissions=Array.isArray(e)?e:[e]}handle(e){try{switch(e){case"granted":return this.invokeReadyEvent(),!0;case"prompt":return this.invokePendingEvent(),!1;case"denied":default:return this.invokeCancelEvent(r.error(r.Errors.permissionDenied)),!1}}catch(e){return this.invokeErrorEvent(e),!1}}register(){const e=this.permissions.map(e=>navigator.permissions.query({name:e}));return Promise.all(e).then(e=>{e.forEach(e=>{this.handle(e.state),e.onchange=(()=>this.handle(e.state))})})}})}}}),System.register("handlers/watch",["handlers/data","providers/permission"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextWatch",class extends n.AppNextDataEvents{constructor(e){super(),this.permission=new r.AppNextPermissionProvider(e),this.permission.onCancel=(e=>this.invokeCancelEvent(e)),this.permission.onError=(e=>this.invokeErrorEvent(e)),this.permission.onPending=(()=>this.invokePendingEvent()),this.permission.onReady=(()=>this.invokeReadyEvent())}request(){return this.permission.register()}})}}}),System.register("sensors/base/sensor",["handlers/watch","handlers/error"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextSensor",class extends n.AppNextWatch{constructor(e,t){super(t),this.factory=e}request(){return this.factory?(this.invokePendingEvent(),super.request().then(()=>{try{this.handler=this.factory()}catch(e){switch(e.name){case"SecurityError":case"ReferenceError":return this.invokeCancelEvent(e);default:this.invokeErrorEvent(e)}}}).catch(e=>this.invokeErrorEvent(e))):Promise.reject(r.error(r.Errors.invalidFactoryFunction))}start(){const e=()=>{this.handler.start(),this.invokeReadyEvent()};return this.handler?(e(),Promise.resolve()):this.request().then(()=>{this.handler&&(this.handler.onerror=(e=>{switch(e.error.name){case"NotAllowedError":case"NotReadableError":return this.invokeCancelEvent(e.error);default:return this.invokeErrorEvent(e.error)}}),this.handler.onreading=(()=>this.invokeDataEvent(this.handler)),e())}).catch(e=>{this.invokeErrorEvent(e)})}stop(){return!!this.handler&&(this.handler.stop(),this.invokeCancelEvent(r.error(r.Errors.featureTerminated)),!0)}})}}}),System.register("sensors/accelerometer",["sensors/base/sensor"],function(e,t){"use strict";var n;t&&t.id;return{setters:[function(e){n=e}],execute:function(){e("AppNextAccelerometerSensor",class extends n.AppNextSensor{constructor(e){super(()=>new Accelerometer(e),"accelerometer")}})}}}),System.register("providers/geolocation",["handlers/watch","handlers/error"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextGeoLocationProvider",class extends n.AppNextWatch{constructor(e){super("geolocation"),this.options=e}start(){return new Promise((e,t)=>{var n=!0;this.id=navigator.geolocation.watchPosition(t=>{n&&(n=!1,this.invokeReadyEvent()),this.invokeDataEvent(t),e()},e=>{n?this.invokeCancelEvent(new Error(e.message)):this.invokeErrorEvent(new Error(e.message)),t()},this.options||{})})}stop(){if(!this.id)return!1;try{return navigator.geolocation.clearWatch(this.id),this.id=null,this.invokeCancelEvent(r.error(r.Errors.featureTerminated)),!0}catch(e){return this.invokeErrorEvent(e),!1}}})}}}),System.register("sensors/gyroscope",["sensors/base/sensor"],function(e,t){"use strict";var n;t&&t.id;return{setters:[function(e){n=e}],execute:function(){e("AppNextGyroscopeSensor",class extends n.AppNextSensor{constructor(e){super(()=>new Gyroscope(e),"gyroscope")}})}}}),System.register("sensors/light",["sensors/base/sensor"],function(e,t){"use strict";var n;t&&t.id;return{setters:[function(e){n=e}],execute:function(){e("AppNextLightSensor",class extends n.AppNextSensor{constructor(e){super(()=>new AmbientLightSensor(e),"ambient-light-sensor")}})}}}),System.register("sensors/magnetometer",["sensors/base/sensor"],function(e,t){"use strict";var n;t&&t.id;return{setters:[function(e){n=e}],execute:function(){e("AppNextMagnetometerSensor",class extends n.AppNextSensor{constructor(e){super(()=>new Magnetometer(e),"magnetometer")}})}}}),System.register("handlers/worker",["handlers/data","handlers/error"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextServiceWorker",class extends n.AppNextDataEvents{constructor(){super(),this.listeners={message:[]}}invoke(e){try{e&&e(this.registration)}catch(e){return this.invokeErrorEvent(e),e}}message(e){try{return this.channel.postMessage(e),!0}catch(e){return this.invokeErrorEvent(e),!1}}onMessage(e){this.listeners.message.push(e)}start(){if(this.registration)return Promise.reject();const e=(e,t)=>{e.forEach(e=>{try{e.call({},t)}catch(e){this.invokeErrorEvent(e)}})};this.invokePendingEvent();try{return this.channel=new BroadcastChannel("app-next-channel"),this.channel.addEventListener("message",t=>e(this.listeners.message,t)),navigator.serviceWorker.register("/app-next-service-worker.js"),navigator.serviceWorker.ready.then(e=>{this.invokeReadyEvent(),this.invokeDataEvent(this.registration=e)}).catch(e=>this.invokeCancelEvent(e))}catch(e){this.invokeCancelEvent(e)}}stop(){const e=e=>(e&&this.invokeErrorEvent(e),Promise.reject());return this.registration?this.registration.unregister().then(t=>{if(t)try{return this.channel.close(),this.invokeCancelEvent(r.error(r.Errors.featureTerminated)),Promise.resolve()}catch(t){return e(t)}return e()}):e()}})}}}),System.register("providers/notifications",["handlers/watch","handlers/error","handlers/data"],function(e,t){"use strict";var n,r,s;t&&t.id;return{setters:[function(e){n=e},function(e){r=e},function(e){s=e}],execute:function(){e("AppNextNotificationsProvider",class extends n.AppNextWatch{constructor(e){super("notifications"),this.active=!1,this.registry={},e.onMessage(e=>{const t=e.data;switch(t.source){case"notification":const e=t.event;if(!e)return;const n=this.registry[e.id];if(!e.id||!n)return;switch(t.on){case"click":n.events.invokeDataEvent(e),this.query(e.id).catch(()=>{delete this.registry[e.id],n.events.invokeCancelEvent(r.error(r.Errors.featureTerminated))})}}}),this.worker=e}query(e){return new Promise((t,n)=>{const r=this.worker.invoke(r=>{r.getNotifications({tag:e}).then(e=>{const r=e[0];r?t(r):n()}).catch(n)});r&&n(r)})}create(e,t,n){if(!this.active)return;const r=s.AppNextDataEvents.from(t),i="app-next-"+(new Date).getTime().toString(36);r.invokePendingEvent(),this.worker.invoke(t=>{t.showNotification(e,Object.assign(n,{tag:i})).then(()=>this.query(i)).then(e=>{this.registry[i]={events:r,notification:e},this.invokeDataEvent(e),r.invokeReadyEvent()}).catch(e=>r.invokeCancelEvent(e))})}request(){return new Promise((e,t)=>{const n=t=>{r||(r=!0,this.active=!0,this.permission.handle(t)||(this.active=!1),e())};var r=!1;const s=Notification.requestPermission(n);s instanceof Promise&&s.then(n).catch(e=>{this.active=!1,this.invokeErrorEvent(e),t(e)})})}start(){return this.active?Promise.reject():this.request()}stop(){if(!this.active)return!1;this.active=!1;try{const e=Object.keys(this.registry),t=e.length;e.forEach(e=>{const t=this.registry[e];try{t.notification.close(),t.events.invokeCancelEvent(r.error(r.Errors.featureTerminated))}catch(e){t.events.invokeErrorEvent(e)}});for(let n=0;n<t;n++)delete this.registry[e[n]];return this.invokeCancelEvent(r.error(r.Errors.featureTerminated)),!0}catch(e){return this.invokeErrorEvent(e),!1}}})}}}),System.register("core",["sensors/accelerometer","providers/geolocation","sensors/gyroscope","sensors/light","sensors/magnetometer","providers/notifications","handlers/worker","handlers/data","handlers/error"],function(e,t){"use strict";var n,r,s,i,o,a,c,u,h,l;t&&t.id;return e("config",function(e){const t=(l.config||{})[e]||{};return t.name=e,t}),{setters:[function(e){n=e},function(e){r=e},function(e){s=e},function(e){i=e},function(e){o=e},function(e){a=e},function(e){c=e},function(e){u=e},function(e){h=e}],execute:function(){e("AppNextCore",l=class e extends u.AppNextDataEvents{constructor(e){super(),this.onCancel=e.onCancel,this.onData=e.onData,this.onError=e.onError,this.onPending=e.onPending,this.onReady=e.onReady,this.providers={geolocation:null,notifications:null},this.sensors={accelerometer:null,gyroscope:null,light:null,magnetometer:null},this.worker=new c.AppNextServiceWorker,this.worker.onError=this.onError}config(t){e.config=t||{}}publish(e){return this.worker.message(e)}subscribe(e){this.worker.onMessage(e)}start(){try{const e={notifications:null};return this.worker.onReady=(()=>{this.providers.geolocation=(e=>new r.AppNextGeoLocationProvider(e)),this.providers.notifications=(()=>(e.notifications||(e.notifications=new a.AppNextNotificationsProvider(this.worker)),e.notifications)),this.sensors.accelerometer=(e=>new n.AppNextAccelerometerSensor(e)),this.sensors.gyroscope=(e=>new s.AppNextGyroscopeSensor(e)),this.sensors.light=(e=>new i.AppNextLightSensor(e)),this.sensors.magnetometer=(e=>new o.AppNextMagnetometerSensor(e))}),this.worker.start().then(()=>{this.invokeReadyEvent(),this.invokeDataEvent(this)}).catch(e=>this.invokeCancelEvent(e))}catch(e){return this.invokeCancelEvent(e),Promise.reject()}}stop(){const e=[this.worker.stop()];return Promise.all(e).then(()=>this.invokeCancelEvent(h.error(h.Errors.featureTerminated)))}})}}}),System.register("handlers/background",["handlers/data","handlers/error"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextBackgroundService",class extends n.AppNextDataEvents{constructor(e){super(),this.code="data:application/x-javascript;base64,"+btoa(e)}request(){try{if(this.worker)return;this.worker=new Worker(this.code),this.invokePendingEvent()}catch(e){this.invokeCancelEvent(e)}}post(e){this.worker.postMessage(e)}start(){if(!this.worker&&(this.request(),!this.worker))return!1;try{return this.worker.onerror=(e=>this.invokeErrorEvent(e.error)),this.worker.onmessage=(e=>{try{this.invokeDataEvent(e)}catch(e){this.invokeErrorEvent(e)}}),this.invokeReadyEvent(),!0}catch(e){return this.invokeCancelEvent(e),!1}}stop(e){return new Promise((t,n)=>{try{1==arguments.length&&this.post(e),setTimeout(()=>{this.worker.terminate(),this.worker.onerror=this.worker.onmessage=null,this.invokeCancelEvent(r.error(r.Errors.featureTerminated)),t()},10)}catch(e){this.invokeErrorEvent(e),n()}})}})}}}),System.register("elements/base/utils",["core"],function(e,t){"use strict";var n;t&&t.id;return{setters:[function(e){n=e}],execute:function(){e("AppNextCustomElementUtils",class{constructor(e){this.support={attribute:(e,t)=>{const n=document.createElement(e);return t in n||(n.setAttribute(t,!0),!!n[t])}},this.container=e}attribute(e,t){switch(arguments.length){case 1:return this.container.getAttribute(e);case 2:this.container.setAttribute(e,t)}}config(){return n.config(this.attribute("config"))}element(e){const t=document.createElement(e);return this.container.attachShadow({mode:"open"}),this.container.shadowRoot.append(t),t}reset(){this.container.innerHTML=""}})}}}),System.register("elements/base/element",["elements/base/utils","handlers/data"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextCustomElement",class extends HTMLElement{constructor(){super(),this.events=new r.AppNextDataEvents,this.utils=new n.AppNextCustomElementUtils(this)}})}}}),System.register("elements/file-saver",["elements/base/element","handlers/error"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextFileSaver",class extends n.AppNextCustomElement{render(){const e=this.utils.config();if(this.utils.reset(),this.events.onCancel=e.oncancel,!this.utils.support.attribute("a","download"))return this.events.invokeCancelEvent(r.error(r.Errors.downloadNotSupported));if(!(e.data instanceof Function))return this.events.invokeCancelEvent(r.error(r.Errors.invalidConfig));try{const t=this.utils.element("a"),n=e.data.call(e),r=this.utils.attribute("label")||"Save",s=this.utils.attribute("name")||(new Date).getTime().toString(36),i=this.utils.attribute("type")||"application/octet-stream";this.events.onError=e.onerror,this.events.onData=e.onsave,this.events.onReady=e.onready,t.download=s,t.href="data:"+i+","+encodeURIComponent(n),t.innerText=r,t.onclick=t.ontouchend=(()=>{this.events.invokeDataEvent({data:n,name:s,type:i,size:(new TextEncoder).encode(n).length})}),this.events.invokeReadyEvent()}catch(e){this.events.invokeErrorEvent(e)}}})}}}),System.register("elements/media-picker",["elements/base/element","handlers/error"],function(e,t){"use strict";var n,r;t&&t.id;return{setters:[function(e){n=e},function(e){r=e}],execute:function(){e("AppNextMediaPicker",class extends n.AppNextCustomElement{render(){this.utils.reset();const e=this.utils.config(),t=this.utils.element("input"),n=this.utils.attribute("type"),s=this.utils.attribute("single"),i=this.utils.attribute("source");this.events.onCancel=e.oncancel,this.events.onData=e.onmedia,this.events.onError=e.onerror,this.events.onReady=e.onready;try{i&&(this.utils.support.attribute("input","capture")?t.capture="auto"==i?"":i:this.events.invokeCancelEvent(r.error(r.Errors.captureNotSupported))),n&&(this.utils.support.attribute("input","accept")?t.accept=n+"/*":this.events.invokeCancelEvent(r.error(r.Errors.acceptNotSupported))),t.multiple=null==s||null==s||""!=s,t.onchange=(()=>this.events.invokeDataEvent(t.files)),t.type="file",this.events.invokeReadyEvent()}catch(e){this.events.invokeErrorEvent(e)}}})}}}),System.register("handlers/scheduler",["handlers/background"],function(e,t){"use strict";var n;t&&t.id;return{setters:[function(e){n=e}],execute:function(){e("AppNextScheduler",class extends n.AppNextBackgroundService{constructor(e=1){super(`\n            function handleError(error)\n            {\n                throw error\n            }\n\n            const tasks = []\n\n            setInterval(() =>\n            {\n                const count = tasks.length,\n                      now = new Date().getTime()\n    \n                for (let i = 0; i < count; i++)\n                {\n                    const task = tasks.shift()\n\n                    try\n                    {\n                        if (now > task.when)\n                        {\n                            postMessage(task)\n                        }\n                        else\n                        {\n                            tasks.push(task)\n                        }\n                    }\n                    catch(error)\n                    {\n                        handleError(error)\n                    }\n                }\n\n            }, ${1e3*e})\n\n            onmessage = event =>\n            {\n                try\n                {\n                    const task = event.data\n\n                    if (!(task.when instanceof Date) || !(task.key))\n                    {\n                        const error = new Error('Invalid task object')\n\n                        error.name = 'invalid task'; handleError(error)\n                    }\n\n                    task.when.setMilliseconds(0)\n                    task.when = task.when.getTime()\n                    tasks.push(task)\n                }\n                catch(error)\n                {\n                    handleError(error)\n                }\n            }\n        `),this.tasks={},this.onData=(e=>{const t=this.tasks[e.data.key];t&&(t.what.call(t.context||{}),this.invokeExecuteEvent(t))})}set onExecute(e){this.execute=e}set onRegister(e){this.register=e}invokeExecuteEvent(e){this.execute&&this.execute(e)}invokeRegisterEvent(e){this.register&&this.register(e)}post(e){const t=(new Date).getTime().toString(36);this.tasks[t]=e,super.post({key:t,when:e.when}),this.invokeRegisterEvent(e)}})}}}),System.register("handlers/reflector",[],function(e,t){"use strict";t&&t.id;return{setters:[],execute:function(){e("AppNextReflector",class{constructor(e){this.events=e,this.start()}invoke(e,t=[]){const n=this.events[e];this.active&&n instanceof Function&&n.apply(this,t)}attach(e){return e instanceof Object?new Proxy(e,{deleteProperty:(e,t)=>t in e&&(delete e[t],this.invoke("onMemberRemove",[e,t]),!0),set:(e,t,n)=>{var r;return t in e?(n={current:n,previous:e[t]instanceof Object?JSON.parse(JSON.stringify(e[t])):e[t]},r="onMemberUpdate"):r="onMemberAttach",e[t]=n,this.invoke(r,[e,t,n]),!0}}):null}start(){return this.active=!0}stop(){return this.active=!1}})}}}),System.register("setup",["handlers/background","elements/file-saver","elements/media-picker","elements/base/element","handlers/scheduler","handlers/reflector"],function(e,t){"use strict";var n,r,s,i,o,a,c,u,h,l;t&&t.id;return{setters:[function(e){n=e},function(e){r=e},function(e){s=e},function(e){i=e},function(e){o=e},function(e){a=e}],execute:function(){c=class{constructor(){this.registry={}}exists(e){return!!this.registry[e]}update(e,t){this.registry[e]=t}},u=class extends c{constructor(){super(),this.register("file-saver",r.AppNextFileSaver),this.register("media-picker",s.AppNextMediaPicker),this.CustomElement=i.AppNextCustomElement}register(e,t){return!customElements||this.exists(e)?null:(customElements.define(e,t),this.update(e,t),t)}},h=class extends c{register(e,t){return!window.Worker||this.exists(e)?null:(this.update(e,t),t)}},l=class{custom(e){e.forEach(e=>this.render(document.querySelectorAll(e)))}render(e=document.querySelectorAll("*")){e.forEach(e=>{e.render instanceof Function&&e.render()})}},e("AppNextSetup",class{constructor(){this.register={element:(e,t)=>this.elements.register(e,t),reflector:e=>new a.AppNextReflector(e),scheduler:e=>(this.scheduler||(this.scheduler=new o.AppNextScheduler(e)),this.scheduler),service:(e,t)=>this.services.register(e,new n.AppNextBackgroundService(t))},this.elements=new u,this.renderer=new l,this.services=new h,addEventListener("load",()=>{this.renderer.custom(Object.keys(this.elements.registry))})}render(e){this.renderer.render(e)}})}}}),this.AppNext=function(e){const t=["core","setup"].map(e=>System.import(e));Promise.all(t).then(t=>{e instanceof Function&&(e={onData:e});const n=new t[0].AppNextCore(e),r=new t[1].AppNextSetup;n.elements=r.elements,n.register=r.register,n.services=r.services,n.CustomElement=n.elements.CustomElement,n.render=(e=>r.render(e)),n.start().then(()=>{})})};