!function(e){"use strict";function t(e,t){if("/"===e.charAt(0)&&(e=e.slice(1)),"."!==e.charAt(0))return e;for(var r=e.split("/");"."===r[0]||".."===r[0];)".."===r.shift()&&t.pop();return t.concat(r).join("/")}function r(e){var t=p[e];return t&&!l[e]&&(l[e]=!0,t.execute()),t&&t.exports}function n(e){return h[e]||r(e)}function s(e,t){var r=[e];r.push.apply(r,t),v.push(r)}function i(e,r,o){if(Array.isArray(e)||"function"==typeof e)s(i,arguments);else{"function"==typeof r&&(o=r,r=[]);var a,c={};p[e]=a={exports:c,deps:r.map(function(r){return t(r,e.split("/").slice(0,-1))}),dependants:[],update:function(e,t){},execute:function(){var t=[];a.deps.map(function(e){var r;"exports"===e?r=a.exports:"module"===e?r=a:(r=h[e])||(r=(r=n(e)&&p[e].exports)&&r.default),t.push(r)});var r=o.apply(null,t);"object"!=typeof a.exports&&(a.exports={default:a.exports}),"object"==typeof r?(r.default=r.default||r,a.exports=c=r):r&&(c.default=r),a.lock=!0,a.dependants.forEach(function(t){p[t]&&!p[t].lock&&p[t].update(e,c)}),a.lock=!1}}}}function o(e){return d[e]||(d[e]=new Promise(function(t,r){var n,s,i;n=(m.baseURL||"")+"/"+e+".js",s=function(){if(delete d[e],v.length){var n=v.shift();n[0].call(this,e,n[1],n[2])}p[e]?t(e):r(new Error("Error loading module "+e))},(i=document.createElement("script")).async&&(i.async=!1),i.addEventListener("load",s,!1),i.src=n,u.appendChild(i)})),d[e]}function a(e){var t=p[e];if(!t)return Promise.reject(new Error("Module "+e+" not loaded"));var r=e+"!";return d[r]?d[r]:d[r]=Promise.all(t.deps.map(function(t){if(h[t]||/module|exports|require/.test(t))return Promise.resolve(t);if(p[t]){var r=t+"!";return l[t]||d[r]?e:d[r]=a(t).then(function(e){return d[r]=Promise.resolve(e),e})}return o(t).then(a)})).then(function(){return e})}function c(e){var n,s=t(e,[]);return(n=h[s])?Promise.resolve(n):(n=p[s])?l[s]?Promise.resolve(n.exports):a(s).then(r):o(s).then(a).then(r)}var u=document.getElementsByTagName("head")[0],d=Object.create(null),l=Object.create(null),p=Object.create(null),h=Object.create(null),v=[];i.amd={jQuery:!0};var m={set:function(e,t){"object"!=typeof t&&(t={default:t}),h[e]=t},get:n,has:function(e){return!!h[e]||!!p[e]},import:c,importAll:function(e){Array.isArray(e)||(e=[].slice.call(arguments));var t=[];return Promise.all(e.map(function(e){var r=/^(.+?)(\.([\w*]+))?$/.exec(e);return e=r[1],t.push(r[3]||"default"),c(e)})).then(function(e){return e.map(function(e,r){return"*"==t[r]?e:e[t[r]]})})},register:function e(r,i,o){if(Array.isArray(r))s(e,arguments);else{var a,c,u=Object.create(null);p[r]=a={exports:u,deps:i.map(function(e){return t(e,r.split("/").slice(0,-1))}),dependants:[],update:function(e,t){c.setters[a.deps.indexOf(e)](t)},execute:function(){a.deps.map(function(e){var t=h[e];t?a.update(e,t):(t=n(e)&&p[e].exports)&&(p[e].dependants.push(r),a.update(e,t))}),c.execute()}},c=o(function(e,t){return u[e]=t,a.lock=!0,a.dependants.forEach(function(e){p[e]&&!p[e].lock&&p[e].update(r,u)}),a.lock=!1,t})}},amdDefine:i,amdRequire:function(e,t){m.importAll(e).spread(t)}};e.System=m,e.define=i,Promise.prototype.spread||(Promise.prototype.spread=function(e){return this.then(function(e){return Promise.all(e)}).then(function(t){return e.apply(this,t)})})}(window),System.register("handlers/data",[],function(e,t){"use strict";t&&t.id;return{setters:[],execute:function(){e("AppNextDataEvents",class{set onCancel(e){this.cancel=e}set onData(e){this.data=e}set onError(e){this.error=e}set onPending(e){this.pending=e}set onReady(e){this.ready=e}invokeCancelEvent(e){try{this.cancel&&this.cancel(e)}catch(e){this.invokeErrorEvent(e)}}invokeDataEvent(e){try{this.data&&this.data(e)}catch(e){this.invokeErrorEvent(e)}}invokeErrorEvent(e){this.error&&this.error(e)}invokePendingEvent(){try{this.pending&&this.pending()}catch(e){this.invokeErrorEvent(e)}}invokeReadyEvent(){try{this.ready&&this.ready()}catch(e){this.invokeErrorEvent(e)}}})}}}),System.register("handlers/error",[],function(e,t){"use strict";var r,n;t&&t.id;return e("error",function(e){const t=n[r[e]];if(!t)return new Error;const s=new Error(t.message);return s.name=t.name,s}),{setters:[],execute:function(){!function(e){e[e.acceptNotSupported=0]="acceptNotSupported",e[e.captureNotSupported=1]="captureNotSupported",e[e.downloadNotSupported=2]="downloadNotSupported",e[e.featureTerminated=3]="featureTerminated",e[e.invalidConfig=4]="invalidConfig",e[e.invalidFactoryFunction=5]="invalidFactoryFunction",e[e.permissionDenied=6]="permissionDenied"}(r||(r={})),e("Errors",r),n={acceptNotSupported:{name:"accept not supported",message:'Input element "accept" attribute is not supported by this device'},captureNotSupported:{name:"capture not supported",message:'Input element "capture" attribute is not supported by this device'},downloadNotSupported:{name:"download not supported",message:'Link element "download" attribute is not supported by this device'},featureTerminated:{name:"feature terminated",message:"Current feature terminated due to user action"},invalidConfig:{name:"invalid config",message:"Config object is missing required members"},invalidFactoryFunction:{name:"invalid factory",message:"Factory function must provide a valid handler instance"},permissionDenied:{name:"permission denied",message:"Requested permission denied by user"}}}}}),System.register("providers/permission",["handlers/data","handlers/error"],function(e,t){"use strict";var r,n;t&&t.id;return{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextPermissionProvider",class extends r.AppNextDataEvents{constructor(e){super(),this.permissions=Array.isArray(e)?e:[e]}register(){function e(e){try{switch(e.state){case"granted":return t.invokeReadyEvent();case"prompt":return t.invokePendingEvent();case"denied":return t.invokeCancelEvent(n.error(n.Errors.permissionDenied))}}catch(e){t.invokeErrorEvent(e)}}const t=this,r=this.permissions.map(e=>navigator.permissions.query({name:e}));return Promise.all(r).then(t=>{t.forEach(t=>{e(t),t.onchange=(()=>e(t))})})}})}}}),System.register("handlers/watch",["handlers/data","providers/permission"],function(e,t){"use strict";var r,n;t&&t.id;return{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextWatch",class extends r.AppNextDataEvents{constructor(e){super();const t=()=>{r=!1,this.invokePendingEvent()};var r=!0;this.permission=new n.AppNextPermissionProvider(e),this.permission.onCancel=(e=>this.invokeCancelEvent(e)),this.permission.onError=(e=>this.invokeErrorEvent(e)),this.permission.onPending=t,this.permission.onReady=(()=>{r&&t(),this.invokeReadyEvent()})}request(){return this.permission.register()}})}}}),System.register("providers/geolocation",["handlers/watch","handlers/error"],function(e,t){"use strict";var r,n;t&&t.id;return{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextGeoLocationProvider",class extends r.AppNextWatch{constructor(e){super("geolocation"),this.options=e}start(){var e=!0;this.id=navigator.geolocation.watchPosition(t=>{e&&(e=!1,this.invokeReadyEvent()),this.invokeDataEvent(t)},t=>{e?this.invokeCancelEvent(new Error(t.message)):this.invokeErrorEvent(new Error(t.message))},this.options||{})}stop(){try{if(!this.id)return;navigator.geolocation.clearWatch(this.id),this.id=null,this.invokeCancelEvent(n.error(n.Errors.featureTerminated))}catch(e){this.invokeErrorEvent(e)}}})}}}),System.register("sensors/base/sensor",["handlers/watch","handlers/error"],function(e,t){"use strict";var r,n;t&&t.id;return{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextSensor",class extends r.AppNextWatch{constructor(e,t){super(t),this.factory=e}request(){return this.factory?(this.invokePendingEvent(),super.request().then(()=>{try{this.handler=this.factory()}catch(e){switch(e.name){case"SecurityError":case"ReferenceError":return this.invokeCancelEvent(e);default:this.invokeErrorEvent(e)}}}).catch(e=>this.invokeErrorEvent(e))):Promise.reject(n.error(n.Errors.invalidFactoryFunction))}start(){this.handler&&(this.handler.onerror=(e=>{switch(e.error.name){case"NotAllowedError":case"NotReadableError":return this.invokeCancelEvent(e.error);default:return this.invokeErrorEvent(e.error)}}),this.handler.onreading=(()=>this.invokeDataEvent(this.handler)),this.handler.start(),this.invokeReadyEvent())}stop(){this.handler&&(this.handler.stop(),this.invokeCancelEvent(n.error(n.Errors.featureTerminated)))}})}}}),System.register("sensors/accelerometer",["sensors/base/sensor"],function(e,t){"use strict";var r;t&&t.id;return{setters:[function(e){r=e}],execute:function(){e("AppNextAccelerometer",class extends r.AppNextSensor{constructor(e){super(()=>new Accelerometer(e),"accelerometer")}})}}}),System.register("core",["providers/geolocation","sensors/accelerometer"],function(e,t){"use strict";var r,n,s;t&&t.id;return e("config",function(e){const t=(s.config||{})[e]||{};return t.name=e,t}),{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextCore",s=class e{constructor(){this.providers={geolocation:e=>new r.AppNextGeoLocationProvider(e)},this.sensors={accelerometer:e=>new n.AppNextAccelerometer(e)}}config(t){e.config=t||{}}})}}}),System.register("handlers/background",["handlers/data","handlers/error"],function(e,t){"use strict";var r,n;t&&t.id;return{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextBackgroundService",class extends r.AppNextDataEvents{constructor(e){super(),this.code="data:application/x-javascript;base64,"+btoa(e)}request(){try{if(this.worker)return;this.worker=new Worker(this.code),this.invokePendingEvent()}catch(e){this.invokeCancelEvent(e)}}send(e){this.worker.postMessage(e)}start(){(this.worker||(this.request(),this.worker))&&(this.worker.onerror=(e=>this.invokeErrorEvent(e.error)),this.worker.onmessage=(e=>{try{this.invokeDataEvent(e)}catch(e){this.invokeErrorEvent(e)}}),this.invokeReadyEvent())}stop(e){try{1==arguments.length&&this.send(e),setTimeout(()=>{this.worker.terminate(),this.worker.onerror=this.worker.onmessage=null,this.invokeCancelEvent(n.error(n.Errors.featureTerminated))},10)}catch(e){this.invokeErrorEvent(e)}}})}}}),System.register("elements/base/utils",["core"],function(e,t){"use strict";var r;t&&t.id;return{setters:[function(e){r=e}],execute:function(){e("AppNextCustomElementUtils",class{constructor(e){this.support={attribute:(e,t)=>{const r=document.createElement(e);return t in r||(r.setAttribute(t,!0),!!r[t])}},this.container=e}attribute(e,t){switch(arguments.length){case 1:return this.container.getAttribute(e);case 2:this.container.setAttribute(e,t)}}config(){return r.config(this.attribute("config"))}element(e){const t=document.createElement(e);return this.container.attachShadow({mode:"open"}),this.container.shadowRoot.append(t),t}reset(){this.container.innerHTML=""}})}}}),System.register("elements/base/element",["elements/base/utils","handlers/data"],function(e,t){"use strict";var r,n;t&&t.id;return{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextCustomElement",class extends HTMLElement{constructor(){super(),this.events=new n.AppNextDataEvents,this.utils=new r.AppNextCustomElementUtils(this)}})}}}),System.register("elements/file-saver",["elements/base/element","handlers/error"],function(e,t){"use strict";var r,n;t&&t.id;return{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextFileSaver",class extends r.AppNextCustomElement{render(){const e=this.utils.config();if(this.utils.reset(),this.events.onCancel=e.oncancel,!this.utils.support.attribute("a","download"))return this.events.invokeCancelEvent(n.error(n.Errors.downloadNotSupported));if(!(e.data instanceof Function))return this.events.invokeCancelEvent(n.error(n.Errors.invalidConfig));try{const t=this.utils.element("a"),r=e.data.call(e),n=this.utils.attribute("label")||"Save",s=this.utils.attribute("name")||(new Date).getTime().toString(36),i=this.utils.attribute("type")||"application/octet-stream";this.events.onError=e.onerror,this.events.onData=e.onsave,this.events.onReady=e.onready,t.download=s,t.href="data:"+i+","+encodeURIComponent(r),t.innerText=n,t.onclick=t.ontouchend=(()=>{this.events.invokeDataEvent({data:r,name:s,type:i,size:(new TextEncoder).encode(r).length})}),this.events.invokeReadyEvent()}catch(e){this.events.invokeErrorEvent(e)}}})}}}),System.register("elements/media-picker",["elements/base/element","handlers/error"],function(e,t){"use strict";var r,n;t&&t.id;return{setters:[function(e){r=e},function(e){n=e}],execute:function(){e("AppNextMediaPicker",class extends r.AppNextCustomElement{render(){this.utils.reset();const e=this.utils.config(),t=this.utils.element("input"),r=this.utils.attribute("type"),s=this.utils.attribute("single"),i=this.utils.attribute("source");this.events.onCancel=e.oncancel,this.events.onData=e.onmedia,this.events.onError=e.onerror,this.events.onReady=e.onready;try{i&&(this.utils.support.attribute("input","capture")?t.capture="auto"==i?"":i:this.events.invokeCancelEvent(n.error(n.Errors.captureNotSupported))),r&&(this.utils.support.attribute("input","accept")?t.accept=r+"/*":this.events.invokeCancelEvent(n.error(n.Errors.acceptNotSupported))),t.multiple=null==s||null==s||""!=s,t.onchange=(()=>this.events.invokeDataEvent(t.files)),t.type="file",this.events.invokeReadyEvent()}catch(e){this.events.invokeErrorEvent(e)}}})}}}),System.register("setup",["handlers/background","elements/file-saver","elements/media-picker","elements/base/element"],function(e,t){"use strict";var r,n,s,i,o,a,c,u;t&&t.id;return{setters:[function(e){r=e},function(e){n=e},function(e){s=e},function(e){i=e}],execute:function(){o=class{constructor(){this.registry={}}exists(e){return!!this.registry[e]}update(e,t){this.registry[e]=t}},a=class extends o{constructor(){super(),this.register("file-saver",n.AppNextFileSaver),this.register("media-picker",s.AppNextMediaPicker),this.CustomElement=i.AppNextCustomElement}register(e,t){return!customElements||this.exists(e)?null:(customElements.define(e,t),this.update(e,t),t)}},c=class extends o{register(e,t){return!window.Worker||this.exists(e)?null:(this.update(e,t),t)}},u=class{custom(e){e.forEach(e=>this.render(document.querySelectorAll(e)))}render(e=document.querySelectorAll("*")){e.forEach(e=>{e.render instanceof Function&&e.render()})}},e("AppNextSetup",class{constructor(){this.register={element:(e,t)=>this.elements.register(e,t),service:(e,t)=>this.services.register(e,new r.AppNextBackgroundService(t))},this.elements=new a,this.renderer=new u,this.services=new c,addEventListener("load",()=>{this.renderer.custom(Object.keys(this.elements.registry))})}render(e){this.renderer.render(e)}})}}}),this.AppNext=function(e){const t=["core","setup"].map(e=>System.import(e));Promise.all(t).then(t=>{const r=new t[0].AppNextCore,n=new t[1].AppNextSetup;r.elements=n.elements,r.register=n.register,r.services=n.services,r.CustomElement=r.elements.CustomElement,r.render=(e=>n.render(e)),e(r)})};